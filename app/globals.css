@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  --font-inter: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  --toast-bg: #ffffff;
  --toast-color: #333333;
  --toast-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
  /* Safe area insets for iOS */
  --safe-area-inset-top: env(safe-area-inset-top, 0px);
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  --safe-area-inset-left: env(safe-area-inset-left, 0px);
  --safe-area-inset-right: env(safe-area-inset-right, 0px);
}

* {
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  height: 100%;
  background: #fafafa;
  /* Prevent iOS Safari zoom on input focus */
  touch-action: manipulation;
}

body {
  font-family: var(--font-inter);
  background: #fafafa;
  min-height: 100%;
  color: #1d1d1f;
  letter-spacing: -0.01em;
  /* Prevent pull-to-refresh on mobile */
  overscroll-behavior-y: contain;
}

html.dark {
  background: #0b0b0c;
  --toast-bg: #1d1d1f;
  --toast-color: #f5f5f7;
  --toast-shadow: 0 10px 40px rgba(0, 0, 0, 0.45);
}

html.dark body {
  background: #0b0b0c;
  color: #f5f5f7;
}

/* Safe area padding utilities for iOS notch/home indicator */
.safe-top {
  padding-top: var(--safe-area-inset-top);
}

.safe-bottom {
  padding-bottom: var(--safe-area-inset-bottom);
}

.safe-left {
  padding-left: var(--safe-area-inset-left);
}

.safe-right {
  padding-right: var(--safe-area-inset-right);
}

/* GPU acceleration for smoother animations */
.gpu-accelerated {
  transform: translateZ(0);
  backface-visibility: hidden;
  perspective: 1000px;
}

/* Smooth transitions base */
* {
  -webkit-tap-highlight-color: transparent;
}

/* Ensure all animated elements use GPU */
[class*="animate-"],
[class*="transition-"] {
  transform: translateZ(0);
  will-change: transform, opacity;
}

/* Subtle background gradient - Apple inspired */
.bg-abstract {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: -1;
  overflow: hidden;
  pointer-events: none;
  background: linear-gradient(180deg, #ffffff 0%, #f5f5f7 100%);
}

html.dark .bg-abstract {
  background: linear-gradient(180deg, #0b0b0c 0%, #121214 100%);
}

.bg-abstract::before {
  content: '';
  position: absolute;
  top: -40%;
  right: -20%;
  width: 70%;
  height: 70%;
  background: radial-gradient(circle, rgba(0, 113, 227, 0.03) 0%, transparent 60%);
  animation: float 25s ease-in-out infinite;
  transform: translateZ(0);
  will-change: transform;
}

html.dark .bg-abstract::before {
  background: radial-gradient(circle, rgba(0, 113, 227, 0.12) 0%, transparent 60%);
}

.bg-abstract::after {
  content: '';
  position: absolute;
  bottom: -30%;
  left: -15%;
  width: 60%;
  height: 60%;
  background: radial-gradient(circle, rgba(168, 85, 247, 0.025) 0%, transparent 60%);
  animation: float 20s ease-in-out infinite reverse;
  transform: translateZ(0);
  will-change: transform;
}

html.dark .bg-abstract::after {
  background: radial-gradient(circle, rgba(168, 85, 247, 0.1) 0%, transparent 60%);
}

/* Gradient text - Apple style */
.gradient-text {
  background: linear-gradient(90deg, #0071e3 0%, #a855f7 50%, #0071e3 100%);
  background-size: 200% auto;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: gradient 8s ease infinite;
}

/* Glass effect - refined (Safari compatible) */
.glass {
  background: rgba(255, 255, 255, 0.72);
  -webkit-backdrop-filter: saturate(180%) blur(20px);
  backdrop-filter: saturate(180%) blur(20px);
}

.glass-strong {
  background: rgba(255, 255, 255, 0.88);
  -webkit-backdrop-filter: saturate(180%) blur(30px);
  backdrop-filter: saturate(180%) blur(30px);
}

/* Custom scrollbar - minimal */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: #d2d2d7;
  border-radius: 10px;
  border: 3px solid transparent;
  background-clip: content-box;
}

::-webkit-scrollbar-thumb:hover {
  background: #aeaeb2;
  border: 3px solid transparent;
  background-clip: content-box;
}

/* Hide scrollbar on mobile for cleaner look */
@media (max-width: 768px) {
  ::-webkit-scrollbar {
    width: 0;
    height: 0;
  }
}

/* Button effects - Apple style */
.btn-primary {
  @apply px-6 py-3 bg-primary-500 text-white font-medium rounded-xl 
         hover:bg-primary-600 active:scale-[0.98] 
         transition-all duration-200 ease-out;
}

.btn-secondary {
  @apply px-6 py-3 bg-gray-900 text-white font-medium rounded-xl 
         hover:bg-gray-800 active:scale-[0.98] 
         transition-all duration-200 ease-out;
}

.btn-outline {
  @apply px-6 py-3 border border-gray-300 text-gray-900 font-medium rounded-xl 
         hover:bg-gray-50 active:scale-[0.98] 
         transition-all duration-200 ease-out;
}

.btn-ghost {
  @apply px-6 py-3 text-primary-500 font-medium rounded-xl 
         hover:bg-primary-50 active:scale-[0.98] 
         transition-all duration-200 ease-out;
}

.btn-danger {
  @apply px-6 py-3 bg-coral-500 text-white font-medium rounded-xl 
         hover:bg-coral-600 active:scale-[0.98] 
         transition-all duration-200 ease-out;
}

/* Card styles - clean, minimal */
.card {
  @apply bg-white rounded-2xl shadow-soft border border-gray-100/50 p-6 
         transition-all duration-300 ease-out;
}

.card-hover {
  @apply hover:shadow-soft-lg hover:-translate-y-0.5;
}

/* Mobile-optimized card padding */
@media (max-width: 640px) {
  .card {
    @apply p-4;
  }
}

/* Input styles - refined */
.input {
  @apply w-full px-4 py-3 bg-white border border-gray-200 rounded-xl 
         focus:outline-none focus:ring-2 focus:ring-primary-500/20 focus:border-primary-500 
         transition-all duration-200 ease-out placeholder:text-gray-400;
  /* Prevent iOS zoom on focus by using 16px min font size */
  font-size: 16px;
}

/* Hide native browser password toggle icons (Edge, Chrome, etc.) */
input[type="password"]::-ms-reveal,
input[type="password"]::-ms-clear,
input[type="password"]::-webkit-credentials-auto-fill-button {
  display: none !important;
}

@media (min-width: 640px) {
  .input {
    font-size: 14px;
  }
}

.input-error {
  @apply border-coral-500 focus:ring-coral-500/20 focus:border-coral-500;
}

/* Label styles */
.label {
  @apply block text-sm font-medium text-gray-700 mb-2;
}

/* Calendar cell animations */
.calendar-cell {
  @apply transition-all duration-200 ease-out cursor-pointer;
}

.calendar-cell:hover {
  @apply bg-gray-50 scale-105;
}

.calendar-cell-today {
  @apply ring-2 ring-primary-500 ring-offset-2;
}

.calendar-cell-selected {
  @apply bg-primary-500 text-white;
}

/* Lesson card */
.lesson-card {
  @apply relative overflow-hidden rounded-xl p-4 transition-all duration-300 ease-out;
}

.lesson-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 3px;
  height: 100%;
  background: #0071e3;
  border-radius: 3px;
}

/* Floating shapes */
.floating-shape {
  position: absolute;
  border-radius: 50%;
  opacity: 0.3;
  animation: float 12s ease-in-out infinite;
}

/* Toast styles */
.toast-success {
  @apply bg-mint-500 text-white;
}

.toast-error {
  @apply bg-coral-500 text-white;
}

/* Badge styles - refined */
.badge {
  @apply inline-flex items-center px-3 py-1 rounded-full text-xs font-medium;
}

.badge-primary {
  @apply bg-primary-50 text-primary-600;
}

.badge-accent {
  @apply bg-accent-50 text-accent-600;
}

.badge-success {
  @apply bg-mint-50 text-mint-600;
}

.badge-warning {
  @apply bg-amber-50 text-amber-600;
}

.badge-danger {
  @apply bg-coral-50 text-coral-600;
}

/* Loading spinner */
.spinner {
  @apply w-6 h-6 border-2 border-gray-200 border-t-primary-500 rounded-full animate-spin;
}

/* Skeleton loading */
.skeleton {
  @apply bg-gray-100 animate-pulse rounded-lg;
}

/* Page transitions */
.page-enter {
  opacity: 0;
  transform: translateY(16px);
}

.page-enter-active {
  opacity: 1;
  transform: translateY(0);
  transition: opacity 400ms ease-out, transform 400ms ease-out;
}

/* Stagger animation for lists */
.stagger-item {
  opacity: 0;
  transform: translateY(16px);
  animation: slideUp 0.6s ease-out forwards;
}

.stagger-item:nth-child(1) { animation-delay: 0.05s; }
.stagger-item:nth-child(2) { animation-delay: 0.1s; }
.stagger-item:nth-child(3) { animation-delay: 0.15s; }
.stagger-item:nth-child(4) { animation-delay: 0.2s; }
.stagger-item:nth-child(5) { animation-delay: 0.25s; }
.stagger-item:nth-child(6) { animation-delay: 0.3s; }
.stagger-item:nth-child(7) { animation-delay: 0.35s; }
.stagger-item:nth-child(8) { animation-delay: 0.4s; }

/* Responsive text */
.text-responsive-sm {
  @apply text-sm sm:text-base;
}

.text-responsive {
  @apply text-base sm:text-lg;
}

.text-responsive-lg {
  @apply text-lg sm:text-xl md:text-2xl;
}

.text-responsive-xl {
  @apply text-xl sm:text-2xl md:text-3xl lg:text-4xl;
}

/* Apple-style link */
.link {
  @apply text-primary-500 hover:text-primary-600 transition-colors duration-200 cursor-pointer;
}

/* Subtle divider */
.divider {
  @apply border-t border-gray-100;
}

/* Section header */
.section-header {
  @apply text-xs font-semibold text-gray-500 uppercase tracking-wider mb-4;
}

/* Mobile-specific utilities */
@media (max-width: 640px) {
  /* Ensure touch targets are at least 44px (Apple HIG) */
  button, 
  a, 
  [role="button"] {
    min-height: 44px;
  }
  
  /* Stack buttons on mobile */
  .button-stack {
    @apply flex flex-col gap-2 w-full;
  }
  
  .button-stack > button,
  .button-stack > a {
    @apply w-full justify-center;
  }
}

/* Touch-friendly table on mobile */
@media (max-width: 768px) {
  .table-mobile {
    @apply block w-full overflow-x-auto;
  }
  
  .table-mobile table {
    @apply min-w-[600px];
  }
}

/* Responsive modal */
@media (max-width: 640px) {
  .modal-content {
    @apply rounded-t-2xl rounded-b-none fixed bottom-0 left-0 right-0 max-h-[90vh] overflow-y-auto;
  }
}

/* Animation keyframes */
@keyframes float {
  0%, 100% {
    transform: translateY(0) translateZ(0);
  }
  50% {
    transform: translateY(-12px) translateZ(0);
  }
}

@keyframes gradient {
  0%, 100% {
    background-position: 0% 50%;
  }
  50% {
    background-position: 100% 50%;
  }
}

@keyframes slideUp {
  0% {
    transform: translateY(20px) translateZ(0);
    opacity: 0;
  }
  100% {
    transform: translateY(0) translateZ(0);
    opacity: 1;
  }
}

/* Safari-specific fixes */
@supports (-webkit-touch-callout: none) {
  /* Fix for Safari position:fixed inside transformed elements */
  .fixed {
    -webkit-transform: translateZ(0);
  }
  
  /* Fix Safari flexbox gap issues */
  .flex {
    -webkit-box-flex: 1;
  }
  
  /* Better momentum scrolling */
  .overflow-auto,
  .overflow-y-auto,
  .overflow-x-auto {
    -webkit-overflow-scrolling: touch;
  }
}

/* Ensure proper viewport height on iOS Safari */
@supports (height: 100dvh) {
  .min-h-screen {
    min-height: 100dvh;
  }
  
  .h-screen {
    height: 100dvh;
  }
}

/* Dark mode scrollbar */
html.dark ::-webkit-scrollbar-thumb {
  background: #48484a;
  border: 3px solid transparent;
  background-clip: content-box;
}

html.dark ::-webkit-scrollbar-thumb:hover {
  background: #636366;
  border: 3px solid transparent;
  background-clip: content-box;
}

/* Print styles - hide navigation */
@media print {
  .sidebar,
  nav,
  .no-print {
    display: none !important;
  }
  
  main {
    margin-left: 0 !important;
    padding: 0 !important;
  }
}
